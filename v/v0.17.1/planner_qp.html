<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NASA Astrobee Robot Software: Quadratic Program (QP) planner</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectlogo"><img alt="Logo" src="astrobee-logo.png" height="100"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NASA Astrobee Robot Software
   &#160;<span id="projectnumber">0.17.1</span>
   </div>
   <div id="projectbrief">Flight software for the Astrobee robots operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('planner_qp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Quadratic Program (QP) planner </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md452"></a>
Overview</h1>
<p>This planner is based off Michael Watterson's PhD thesis. We generate trajectories by running an optimization which minimizes the functional:</p>
<div class="image">
<img src="planner_qp_cost.png" alt=""/>
<div class="caption">
alt text</div></div>
   <p>With collision avoidance constraints and scaling to ensure dynamic feasibility.</p>
<h1><a class="anchor" id="autotoc_md453"></a>
Usage</h1>
<p>To generate and execute a optimized plan one should use the move command in conjunction with the "qp" planner flag. Here is an example command that shows how to move to the origin of the world: </p><pre class="fragment">rosrun mobility teleop -move -pos "0 0 0" -att "0" -planner qp
</pre><p>By default the teleop tool configures the platform to operate in holomonic mode. To enforce face-forward mode the "-ff" flag can be used. For example: </p><pre class="fragment">rosrun mobility teleop -move -pos "0 0 0" -att "0" -planner qp -ff
</pre><h1><a class="anchor" id="autotoc_md454"></a>
Trajectory Display</h1>
<p>This planner comes with an rviz plug-in to view the generated trajectories. <br  />
</p>
<div class="image">
<img src="planner_qp_rviz_1.png" alt=""/>
<div class="caption">
alt text</div></div>
   <p>From the display panel, add the traj_opt_ros trajectory plug-in.</p>
<div class="image">
<img src="planner_qp_rviz_2.png" alt=""/>
<div class="caption">
alt text</div></div>
   <p>Change the topic in the plug-in to either the current trajectory or a debug version. Here the regular trajectory is plotted in magenta and the debug is plotted in red. The debug shows the optimization at each iteration as it converges to the current trajectory.</p>
<h1><a class="anchor" id="autotoc_md455"></a>
Parameter Description</h1>
<p>The planner has adjustable parameters which can affect the optimizer's performance which are configurable through the reconfigure GUI. </p><pre class="fragment">rosrun rqt_reconfigure rqt_reconfigure
</pre><div class="image">
<img src="planner_qp_config.png" alt=""/>
<div class="caption">
alt text</div></div>
   <ul>
<li><code>sample_rate</code> - The optimization uses a continuous trajectory representation which is sub-sampled at this rate before being sent to the choreographer.</li>
<li><code>planner_distance</code> - Additional distance that the planner should stay away from occupied areas. The occupied areas are defined by the zones and obstacles inflated using the robot radius plus the collision distance. The minimum planner distance is set to the map resolution because otherwise interpolation and upsampling of the trajectory points bordering the occupied areas will generate points inside the occupied areas. Increase this to create a trajectory further away from walls.</li>
<li><code>two_d</code> - Force the z coordinate of the goal to be the same as the start. (Mainly for use on the granite table)</li>
<li><code>uniform_time_allocation</code> - Make each segment in trajectory spline take the same amount of time. This usually makes performance worse to enable this.</li>
<li><code>time_optimization</code> - Iterates on trajectory spline time allocation. With this option result is better, but takes longer to compute. This also makes the optimization no longer a quadratic program and non-convex.</li>
<li><code>duality_gap_threshold</code> - Main optimization termination criteria, see Bemporad-Morari MPC book for details. Higher is faster, but less optimal. Lower is more optimal, but slower to compute.</li>
<li><code>maximum_iterations</code> - Limit maximum number of iterations when performing optimization.</li>
<li><code>iteration_replay</code> - Changes speed of the debug trajectory animation. Represents the number of seconds for the entire animation. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
<script type="text/javascript" src="/astrobee/doc_version_select.js"></script>
</body>
</html>

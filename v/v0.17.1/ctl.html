<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NASA Astrobee Robot Software: Control (CTL)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectlogo"><img alt="Logo" src="astrobee-logo.png" height="100"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NASA Astrobee Robot Software
   &#160;<span id="projectnumber">0.17.1</span>
   </div>
   <div id="projectbrief">Flight software for the Astrobee robots operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ctl.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Control (CTL) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The control subsystem takes the pose from the EKF, as well as control commands, to determine the forces and torques that should be applied to the robot for smooth control. If executes the given segment based on a trajectory given by the choreographer, the fault checking on the execution is done in the choreographer based on the feedback.</p>
<p>The layout of this module is a bit complicated for historical reasons&mdash; the ctl_nodelet is a thin wrapper to the Ctl class in <a class="el" href="ctl__ros_8h.html">ctl_ros.h</a> which interfaces between different modules via ROS. The Control class in <a class="el" href="ctl_8h.html">ctl.h</a> then implements the main underlying functionality.</p>
<h1><a class="anchor" id="autotoc_md236"></a>
Inputs</h1>
<ul>
<li><code>gnc/ekf</code>: EKF State from EKF</li>
<li><code>gnc/ctl/control</code> Action. See the Control action specification for details.</li>
</ul>
<h1><a class="anchor" id="autotoc_md237"></a>
Outputs</h1>
<ul>
<li><code>gnc/ctl/command</code>: The force and torque commanded by control.</li>
<li><code>gnc/ctl/shaper</code>: The output from the GNC command shaper, which smooths the control.</li>
<li><code>gnc/ctl/traj</code>: The trajectory that the control subsystem is being commanded to follow.</li>
<li><code>gnc/ctl/segment</code>: The current segment the control subsystem is traversing.</li>
<li><code>gnc/ctl/progress</code>: The progress in executing the current segment.</li>
</ul>
<h1><a class="anchor" id="autotoc_md238"></a>
GNC Control Wrapper behavior</h1>
<p><div class="dotgraph">
<img src="dot_ctl_fsm.png" alt="dot_ctl_fsm.png" border="0" usemap="#dot_ctl_fsm.map"/>
<div class="caption">
GNC Control Wrapper finite state machine</div>
</div>
</p>
<ul>
<li>WAITING: No setpoints sent to the internal Matlab controller.</li>
<li>NOMINAL: Waits until the start time for deferred executions, commands the setpoints to the internal Matlab in nominal mode until the desired trajectory is finished.</li>
<li>STOPPING: Commands internal Matlab into stopping mode. When the velocity and angular velocity fall under a certain stop threshould, it succeeds.</li>
</ul>
<h1><a class="anchor" id="autotoc_md239"></a>
Modes</h1>
<p>The controller internally has four modes:</p><ul>
<li>Idle: No control is present.</li>
<li>Stopping: Position error is calculated based on the delayed current position and the current position. Velocity and acceleration commands are zero.</li>
<li>Nominal: It follows the trajectory given for position, velocity and acceleraion.</li>
<li>Stopped: Position/Attitude error is zero. Control Velocity and acceleration goals are zero.</li>
</ul>
<h1><a class="anchor" id="autotoc_md240"></a>
Enable/Disable Control</h1>
<p>In the case a new controller is to be tested, it is possible to enable/disble the current controller using the service <code>gnc/ctl/enable</code>. <code>true</code> will enable the control and <code>false</code> will disable it. If the requested state is the one already active, then the service does not return success. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
<script type="text/javascript" src="/astrobee/doc_version_select.js"></script>
</body>
</html>

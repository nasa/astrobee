<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NASA Astrobee Robot Software: Total Station</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectlogo"><img alt="Logo" src="astrobee-logo.png" height="100"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NASA Astrobee Robot Software
   &#160;<span id="projectnumber">0.17.0</span>
   </div>
   <div id="projectbrief">Flight software for the Astrobee robots operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('total_station.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Total Station </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md436"></a>
Doing a Survey with the Total Station</h1>
<p>This will tell you how to just operate the Total Station device. When you use it in practice, you'll want to set your reference to the -1, -1, -1 corner on the aluminum frame in granite. Then you'll want to survey the following:</p>
<ul>
<li>The corners of the black squares on well-distributed set of AR targets, so that the AR tags can be in the global coordinate frame.</li>
<li>The body of the overhead camera, so that the overhead's position estimate is accurate to the global coordinate frame.</li>
</ul>
<p>After you have surveyed the above and anything else of interest to you, you should add the vector [-1, -1, -1] to all measurements as we traditionally like the origin to be the center of the beacon volume in granite lab.</p>
<ol type="1">
<li>Get the Leica Total Station which is in the red box just outside the Garage (not roverscape).</li>
<li>Set it up in the granite lab. Place down some carpet so the legs don't slip. Place and screw down the top unit to the stand. There is a bubble level on side of the top unit. Zero it by adjusting the 3 turn knobs.</li>
<li>Power on the unit by pressing and holding the "prog" button.</li>
<li>Ensure that the battery is charged, otherwise use the charger to charge it.</li>
<li>You are now ready to start a survey.</li>
<li>Press "1" to Survey a. Press Enter a. F2 for new Job a. Write job name, then hit 'Enter' a. Use CE to erase a. Use F6 to switch into letter mode a. Press F1 to store solution a. Press F1 to continue a. May need to press F1 again a. For the Reflector option, switch to Reflectorless mode (otherwise there will be an error about a missing prism).</li>
<li>Press "F3" to Setup Coordinate System a. Select method, change to "Local Resection". a. Select stn ht from, change to "Target 1 Ht Diff". a. Select station ID, enter the value "FRONTOFGRANITE" (or something shorter).</li>
<li>Press "F1" to continue and survey the origin. a. Select "Point ID", enter the value "ORIGIN" (or some other value). a. Move the sights to look at a corner bolt of the aluminum frame (if in the granite lab). This will be the origin of the output coordinate system. a. Use the knobs to zero the cross hairs perfectly on the bolt. You might also need to change the focus of the sights. a. Once aligned correctly, press "F2" to get a distance measurement. a. Press "F3 to record the measurement.</li>
<li>Now you are ready to survey the Y axis reference. Z axis will be aligned with gravity, pointing towards the sky. a. Select "Point ID", enter the value "YREF" (or some other value). a. Move the sights to look at the opposite corner bolt of the aluminum frame. a. Once aligned correctly, use "F1" to record distance and save the point. If you get an error about point distribution, you will have to redo the ORIGIN and YREF points as further apart (use at least a few meters among them).</li>
<li>Press "F1" to set.</li>
<li>Press "F4" ok.</li>
<li>You are now ready to survey things. Keep on centering the cross-hairs on new points and pressing F3 to record it. Survey a well-distributed set of AR tag corners on room walls and survey for example the top left, top right, bot left corners of each of them. Each AR tag has an ID printed on it, that can be associated with each measurement.</li>
</ol>
<p>Once you are done you need to export your project to the GSI format so you can read it back in.</p>
<ul>
<li>Keep hitting ESC until you are back to the home screen.</li>
<li>Press "4" to convert.</li>
<li>Press "1" to export.</li>
<li>Select Job, change to what ever is your job.</li>
<li>Select Format File, change to "gsi16_cartesian.frt".</li>
<li>Select File Name, write value for what you want the output file to be.</li>
<li>Press "F1" to save.</li>
<li>Press "F4" to exit.</li>
</ul>
<p>Turn the nob on the side of the station where it says "CF Card" and pull the card out. Hook it up to a USB reader and get the measurement file. Here is a sample data file: </p><pre class="fragment">*110001+0000000000ORIGIN 81...0+0000000000000000 82...0+0000000000000000 83...0+0000000000000000 
*110002+000000000000YREF 81...0+0000000000000000 82...0+0000000000006417 83...0-0000000000000022 
*110003+0000000000000003 81...0+0000000000000004 82...0+0000000000006535 83...0-0000000000000786 
</pre><p>What this means is that the points are in Cartesian coordinates with x,y,z measured in millimeters (note that some values are negative). After removing the redundant text and converting to meters, this looks like: </p><pre class="fragment">Point 1 (Origin): 0.0    0.0      0.0
Point 2 (YREF)  : 0.0    6.417    -0.022
Point 3         : 0.004  6.535    -0.786     
</pre><p>The program: </p><pre class="fragment">localization/sparse_mapping/tools/parse_total_station.py
</pre><p>can be used to convert from the Total Station format to an xyz format that can be used for sparse map registration.</p>
<p>When you are done, shut off the machine:</p>
<ul>
<li>Keep hitting ESC until you are back to the home screen.</li>
<li>Press USER and PROG at the same time.</li>
<li>Press "F6" to confirm. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
<script type="text/javascript" src="/astrobee/doc_version_select.js"></script>
</body>
</html>

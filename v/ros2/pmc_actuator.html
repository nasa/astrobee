<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NASA Astrobee Robot Software: PMC actuator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectlogo"><img alt="Logo" src="astrobee-logo.png" height="100"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NASA Astrobee Robot Software
   &#160;<span id="projectnumber">0.17.0</span>
   </div>
   <div id="projectbrief">Flight software for the Astrobee robots operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pmc_actuator.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PMC actuator </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md220"></a>
How to test the PMC - Using bare C++ program</h1>
<p>On the <code>llp</code>, run the following program: </p><div class="fragment"><div class="line">pmc_actuator_tool -h</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md221"></a>
How to test the PMC - Using ROS Nodes</h1>
<h2><a class="anchor" id="autotoc_md222"></a>
Basic procedure</h2>
<p>Open two ssh sessions on LLP</p>
<p>Terminal 1 on LLP: </p><pre class="fragment">source setup.bash
roslaunch pmc_actuator pmc_actuator.launch
</pre><p>Terminal 2 on LLP: </p><pre class="fragment">source setup.bash
rosrun pmc_actuator pmc_actuator_cmd_test
</pre><p><b>Note:</b> Detailed procedure to run the sound tests is in the attached document&#160;<code>sound-test-process.txt</code>.</p>
<h2><a class="anchor" id="autotoc_md223"></a>
Control the type of nozzle motions</h2>
<p><code>pmc_actuator_cmd_test</code> performs by default a triangular profile for the nozzles with the blowers at the nominal speed.</p>
<p><b>WARNING: The instructions below are obsolete. Run <code>pmc_actuator_test -h</code> to check the new command line arguments! Text below is waiting for cleaning...</b></p>
<p>The program accept up to 7 arguments that can override these defaults:</p>
<ol type="1">
<li>blower_speed_side1 (pwm value)</li>
<li>blower_speed_side2 (pwm value)</li>
<li>start_nozzle_position_side1 (pwm value)</li>
<li>start_nozzle_position_side2 (pwm value)</li>
<li>nozzle_increment_side1 (float)</li>
<li>nozzle_increment_side2 (float)</li>
<li>time_before_starting_sequence (seconds)</li>
</ol>
<p>All nozzles on one propulsion module are given the same position and increment/decrement in a triangular pattern. An zero increment will simply keep the nozzle positions static.</p>
<p>For example, to have the left and right nozzles working in opposition at nominal blower speed: </p><pre class="fragment">rosrun pmc_actuator pmc_actuator_cmd_test 207 207 25 96 1 -1 5
</pre><p>Side 1 will start at nozzle position 25 (fully closed) and increment at each cycle (62.5Hz) by 1. When it reaches the maximum value it starts to decrements. Side 2 will start at nozzle position 96 (fully open) and decrements at each cycle by 1. When it reaches the minimum value, it will start to increment. The nozzle positions keep oscillating following a triangular profile between the min and max acceptable nozzle positions.</p>
<p>Command all nozzles closed at 2000rpm: </p><pre class="fragment">rosrun pmc_actuator pmc_actuator_cmd_test 166 166 25 25 0 0
</pre><p>Command all nozzles open at 3000rpm: </p><pre class="fragment">rosrun pmc_actuator pmc_actuator_cmd_test 249 249 96 96 0 0
</pre><p>Triangular pattern with slow open/close: </p><pre class="fragment">rosrun pmc_actuator pmc_actuator_cmd_test 207 207 25 25 0.2 0.2
</pre><h2><a class="anchor" id="autotoc_md224"></a>
Disable the blowers</h2>
<p>The PMC firmware cannot put the servo in idle mode. However, the shutdown command can turn off the motor controller on the blowers. So the servos can be controlled with the above commands without the blower spinning by issuing first this command: </p><pre class="fragment">rosservice call /pmc_actuator/enable false
</pre><p>To re-enable the blowers: </p><pre class="fragment">rosservice call /pmc_actuator/enable true
</pre><h2><a class="anchor" id="autotoc_md225"></a>
PWM values</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Blower speed rpm </th><th class="markdownTableHeadCenter">PWM value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">2000 </td><td class="markdownTableBodyCenter">166  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">2500 </td><td class="markdownTableBodyCenter">207  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">2800 </td><td class="markdownTableBodyCenter">232  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">3000 </td><td class="markdownTableBodyCenter">249  </td></tr>
</table>
<hr  />
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Nozzle position </th><th class="markdownTableHeadCenter">PWM value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">Closed </td><td class="markdownTableBodyCenter">25  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">Open </td><td class="markdownTableBodyCenter">96  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md227"></a>
Create arbitrary nozzle pattern and blower speeds</h2>
<p>The program <code>pmc_actuator_feeder</code> allow to describe any sequence of motion using a csv file.</p>
<p>For example, the following command will cycle through each nozzle and open it for a few seconds: </p><pre class="fragment">rosrun pmc_actuator pmc_actuator_feeder ./nozzle_identification.csv

# File format:
#   - 1 line per command
#   - lines starting with # or space are ignored
#   - 15 fields required, space as separator
#   - fields:
#     - time (in seconds, relative to the start of the program)
#     - side 1 blower speed
#     - side 2 nozzle position x 6
#     - side 2 blower speed
#     - side 2 nozzle position x 6
</pre><h2><a class="anchor" id="autotoc_md228"></a>
Check telemetry from the PMCs</h2>
<p>In a terminal with the correct ROS setup, just type: </p><pre class="fragment">rostopic echo /pmc_actuator/telemetry
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
<script type="text/javascript" src="/astrobee/doc_version_select.js"></script>
</body>
</html>

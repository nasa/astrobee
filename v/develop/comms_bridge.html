<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NASA Astrobee Robot Software: DDS Generic Comms Bridge</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectlogo"><img alt="Logo" src="astrobee-logo.png" height="100"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NASA Astrobee Robot Software
   &#160;<span id="projectnumber">0.19.1</span>
   </div>
   <div id="projectbrief">Flight software for the Astrobee robots operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('comms_bridge.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">DDS Generic Comms Bridge </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a bidirectional bridge to communicate between different astrobees or ros clients using DDS to relay the topics. Supporting an arbitrary number of in-out topics, relaying of ROS messages from one topic to another, without any specification of the message types, nor even the requirement that the types be available to the nodes at compile-time.</p>
<h2><a class="anchor" id="autotoc_md250"></a>
Basic architecture</h2>
<ul>
<li>The subscriber class (A) subscribes to a specified list of topics</li>
<li>Upon receipt of the first message on a given forwarded topic, A sends an advertisement message to a metadata "advertisement" topic</li>
<li>Receiving the metadata advertisement, the republisher class (B) itself advertises the output (republished) topic</li>
<li>The first and all subsequent messages A receives are serialized and published to a metadata "content" topic</li>
<li>A delay is implemented in B between its advertising and subsequent republishing of any messages to practically avoid the potential race condition of a subscriber on that end missing the first message as it connects to B only upon seeing the advertisement</li>
<li>Otherwise, B deserializes all messages received on the "content" metadata topic, looks up the topic in previously received "advertisement" metadata, and republishes the message on the output topic</li>
<li>In this implementation, the metadata advertisement info and content are converted to and passed over dds.</li>
</ul>
<h2><a class="anchor" id="autotoc_md251"></a>
Enabling DDS Communication</h2>
<p>The generic comms bridge runs by default when the astrobee flight starts up. By default, dds publishing and subscribing is disabled since astrobee to astrobee communication is not desired for every activity. There are 2 ways to enable it. One can either change the 'initialize_dds_on_start' parameter in the comms bridge config file to true before starting flight software or send an "enable astrobee
intercomms" command to astrobee after the flight software has started.</p>
<h2><a class="anchor" id="autotoc_md252"></a>
Specifying Topics</h2>
<p>To add topics to be passed between robots, please see the comms bridge config file. The comments in the config file should explain how to add topics.</p>
<h2><a class="anchor" id="autotoc_md253"></a>
DDS Specifics</h2>
<h3><a class="anchor" id="autotoc_md254"></a>
Discovery Peers File</h3>
<p>In order to have two or more Astrobees communicate, one must add the ip addresses to the "NDDS_DISCOVERY_PEERS" file in the "dds_generic_comms" folder. Be sure to add a semi-colon (;) to the end of every line added.</p>
<h3><a class="anchor" id="autotoc_md255"></a>
QoS Profile</h3>
<p>By default, DDS properties are used to ensure the advertisement info messages are reliably deliveried to the republisher class even if the subscriber or republisher are restarted. Currently, DDS is configured to work if there are no more than 20 topics being passed between robots. If more topics are required, please change the message depth in the "RAPID_QOS_PROFILES.xml" file in the "dds_generic_comms" folder. The depth for the "RapidReliableDurableQos" will need to be changed for both the "datareader_qos" and the "datawriter_qos". This should be on or around lines 206 and 218 in the file. You will also need to change the value check in the "comms_bridge_nodelet.cpp" file on or around line 307. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
<script type="text/javascript" src="/astrobee/doc_version_select.js"></script>
</body>
</html>
